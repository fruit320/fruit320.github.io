<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
<meta name="google-site-verification" content="lzzy81dXBMl3CL0W3rihaSIaVK5AarDtjDI7NuLjWo0" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Fruit&#39;s Blogs">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Fruit&#39;s Blogs">
<meta property="og:description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="fruit">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Fruit's Blogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Fruit's Blogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/06/glibc%E4%BD%8E%E7%89%88%E6%9C%AC%E5%88%B0%E9%AB%98%E7%89%88%E6%9C%AC%E5%88%87%E6%8D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/06/glibc%E4%BD%8E%E7%89%88%E6%9C%AC%E5%88%B0%E9%AB%98%E7%89%88%E6%9C%AC%E5%88%87%E6%8D%A2/" class="post-title-link" itemprop="url">glibc低版本到高版本切换</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-06-06 12:33:17 / Modified: 12:44:56" itemprop="dateCreated datePublished" datetime="2021-06-06T12:33:17+08:00">2021-06-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>环境折腾了好久  所以记录一下</p>
<p>题目涉及到glibc 2.29 由于我这个虚拟机是glibc2.23  所以需要重新弄一下动态链接库</p>
<p>原本是管学长要了一个glibc的各个版本的压缩包</p>
<p>解压配置了以后发现没有符号表  导致pwndbg的部分功能用不了</p>
<p>所以最后改成了glibc-all-in-one 里面有详细的下载教程  并且下载后里面有一个隐藏文件夹.debug 里面有符号表</p>
<p>下载patchelf</p>
<p>改路径的时候要写绝对路径</p>
<p>最后在pwntools里面加载</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env&#x3D;&#123;&quot;LD_PRELOAD&quot;:&quot;&#x2F;home&#x2F;giantbranch&#x2F;Desktop&#x2F;glibc-all-in-one-master&#x2F;libs&#x2F;2.29-0ubuntu2_amd64&#x2F;libc-2.29.so&quot;&#125;)</span><br></pre></td></tr></table></figure>

<p>其他高版本同。可以开心的pwn了</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/23/fuzzing%20book%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/23/fuzzing%20book%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">fuzzing book读书笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-05-23 23:16:15" itemprop="dateCreated datePublished" datetime="2021-05-23T23:16:15+08:00">2021-05-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-05-24 15:28:37" itemprop="dateModified" datetime="2021-05-24T15:28:37+08:00">2021-05-24</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="fuzzing-architecture"><a href="#fuzzing-architecture" class="headerlink" title="fuzzing architecture"></a>fuzzing architecture</h4><p>runner classes</p>
<p>fuzzer classes</p>
<p>code coverage</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/04/tw/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/04/tw/" class="post-title-link" itemprop="url">tw刷题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-05-04 23:57:05" itemprop="dateCreated datePublished" datetime="2021-05-04T23:57:05+08:00">2021-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-06-07 00:00:49" itemprop="dateModified" datetime="2021-06-07T00:00:49+08:00">2021-06-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>tw的题很有意思  有cve  更偏向于实战  这里只记录坑点  wp 不写</p>
<h4 id="start-–-tw"><a href="#start-–-tw" class="headerlink" title="start – tw"></a>start – tw</h4><p>坑点：这题当时把我困住了因为checksec 是nx开启的 一时半会儿想不明白要如何做readelf -l ./start文章里面<a target="_blank" rel="noopener" href="https://medium.com/@en3sec/pwnable-tw-start-8db4fe02120e%E8%AE%B2%E8%BF%B0%E4%BA%86">https://medium.com/@en3sec/pwnable-tw-start-8db4fe02120e讲述了</a> checksec的bug由于没有GNU_STACK段 所以 checksec会显示nx enable</p>
<h4 id="orw-–-tw"><a href="#orw-–-tw" class="headerlink" title="orw – tw"></a>orw – tw</h4><p>使用orw如何写shellcode  可以用pwntools的shellcraft</p>
<h4 id="calc-–-tw"><a href="#calc-–-tw" class="headerlink" title="calc – tw"></a>calc – tw</h4><p>坑点：栈上的数据 是以有符号数存在的， 泄露的ebp在发送时被当作无符号数发送，超过了有符号数的范围，导致getshell失败， 所以将ebp减去2的32次方转化为负数， 但是相关二进制位没有改变</p>
<h5 id="cve-2018-1060-–-tw"><a href="#cve-2018-1060-–-tw" class="headerlink" title="cve-2018-1060 – tw"></a>cve-2018-1060 – tw</h5><p>这题的alsr我没看懂怎么绕过   所以也没解出来  这题的cve原理需要阅读源码  可以提升源码阅读的功力  linux c写的  cve的原理大概懂了   很有意思的溢出  溢出点相当于在协议栈中   在处理数据包的拷贝上  是一个比赛的原题</p>
<h4 id="3x17-–-tw"><a href="#3x17-–-tw" class="headerlink" title="3x17 – tw"></a>3x17 – tw</h4><p>这道题是一个strip程序  学到了如何在strip的条件下找到main函数  以及main函数的运行流程  这里看了《程序员自我修养》那本书的相关章节  在写wp的时候需要记得read函数不填\0  而且\n是接收的  后面需要栈迁移  </p>
<h4 id="dubblesort-–-tw"><a href="#dubblesort-–-tw" class="headerlink" title="dubblesort – tw"></a>dubblesort – tw</h4><p>这道题溢出点很好找  选择排序  保护全开 关键是如何绕过ALSR和canary  </p>
<p>坑点有3个</p>
<p>1）scanf 在输入%u时  如果输入’+/-‘ 那么不会改变栈值</p>
<p>2）如何利用栈里面的数据泄露libc 相关值</p>
<p>3）ida里面反的ebp的相对位移有问题  (这个最坑。。。。。)</p>
<h4 id="hacknote-–-tw"><a href="#hacknote-–-tw" class="headerlink" title="hacknote –  tw"></a>hacknote –  tw</h4><p>leak libc 覆盖systemaddr 和 一个oj的itemboard有点像    很像。。</p>
<p>坑点：0xaa;sh;</p>
<h4 id="silver-bullet-–-tw"><a href="#silver-bullet-–-tw" class="headerlink" title="silver_bullet – tw"></a>silver_bullet – tw</h4><p>strncat后面会自动加’\0’</p>
<h4 id="re-alloc-–-tw"><a href="#re-alloc-–-tw" class="headerlink" title="re-alloc  – tw"></a>re-alloc  – tw</h4><p>libc2.29 之上在需要绕过tcache libc2.29 中tache double free检查<br>patchelf –replace-needed libc.so.6 ./2.29/libc.so.6 ./re-alloc关于环境配置  已经写在博客里面<br>漏洞点：realloc 函数造成的UAF 不知道本地为啥不行 但是远程可以  本地调用system但是弹不出来 </p>
<h4 id="applestore-–-tw"><a href="#applestore-–-tw" class="headerlink" title="applestore – tw"></a>applestore – tw</h4><p>这个题很有意思 打算详细写学到了很多。购物车构造了一个双向链表<br>这个结构让我想起了unlink attack ，当然我控制不了指针 没有溢出 asprintf 函数是动态生成的内存空间没有进行释放都没有进行free 程序里所有的malloc都没有free很显然这样很不好。但是如果光靠这一点拿到shell不太可能</p>
<p>后来发现栈可利用 从而可以实现类似于unlink attack  （简化版的）</p>
<p>题目设计的非常有意思</p>
<p>tcache tear – tw</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/04/idapython%20(ida7.5)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/04/idapython%20(ida7.5)/" class="post-title-link" itemprop="url">ida7.5 里面的python3  版本下的idapython基本使用  && 常用函数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-05-04 11:22:58 / Modified: 23:56:28" itemprop="dateCreated datePublished" datetime="2021-05-04T11:22:58+08:00">2021-05-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ida7-5-里面的python3-版本下的idapython使用"><a href="#ida7-5-里面的python3-版本下的idapython使用" class="headerlink" title="ida7.5 里面的python3  版本下的idapython使用"></a>ida7.5 里面的python3  版本下的idapython使用</h2><p>idapython  一般和ida结合来进行二进制分析工作（自动化漏洞挖掘和逆向分析，如去混淆  去反调试等），可以提高安全人员分析效率。</p>
<p>下面只介绍一些基本的使用和一些简单的小脚本</p>
<p>后续的练习 还要多看别人写的脚本  并自己多加练习才可</p>
<h3 id="获取当前位置的相关属性"><a href="#获取当前位置的相关属性" class="headerlink" title="获取当前位置的相关属性"></a>获取当前位置的相关属性</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ea &#x3D; here()  #获取当前地址</span><br><span class="line">idc.get_segm_name(ea) #段名</span><br><span class="line">idc.get_func_name(ea)  #函数名</span><br><span class="line">func &#x3D; ida_funcs.get_func(ea)   </span><br><span class="line">func.start_ea  #函数起始地址</span><br><span class="line">func.end_ea    #函数结束地址</span><br><span class="line">idc.GetDisasm(ea)  #当前位置反汇编</span><br><span class="line">idc.print_insn_mnem(ea)  #指令名称  sub mov等</span><br><span class="line">idc.next_head(ea)  #获取下一个指令地址</span><br><span class="line">idc.prev_head(ea)</span><br><span class="line">idc.next_addr(ea) #获取下一个地址</span><br><span class="line">idc.prev_addr(ea) </span><br><span class="line">idc.is_code(idc.get_full_flags(ea)) #地址是否是代码</span><br></pre></td></tr></table></figure>


<h3 id="遍历segment"><a href="#遍历segment" class="headerlink" title="遍历segment"></a>遍历segment</h3><p>列表中的每个项都是段的起始地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for seg in idautils.Segments():</span><br></pre></td></tr></table></figure>


<h3 id="遍历所有函数"><a href="#遍历所有函数" class="headerlink" title="遍历所有函数"></a>遍历所有函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for func in idautils.Functions():</span><br><span class="line">	idc.get_func_name(func)</span><br></pre></td></tr></table></figure>


<h3 id="获取函数中的指令"><a href="#获取函数中的指令" class="headerlink" title="获取函数中的指令"></a>获取函数中的指令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for func in idautils.Functions(): </span><br><span class="line">    dism_addr &#x3D; list(idautils.FuncItems(func))   #  结果为一个list格式</span><br><span class="line">    for line in dism_addr:  </span><br><span class="line">        m &#x3D; idc.print_insn_mnem(line)  # 指令名称</span><br><span class="line">        if m &#x3D;&#x3D; &#39;call&#39; or m &#x3D;&#x3D; &#39;jmp&#39;:</span><br><span class="line">            pass</span><br></pre></td></tr></table></figure>


<h3 id="获取操作数"><a href="#获取操作数" class="headerlink" title="获取操作数"></a>获取操作数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idc.get_operand_type(ea,n)</span><br></pre></td></tr></table></figure>


<p>其中ea 为地址，n为索引。</p>
<p>其返回类型有八种 + 不同的处理器 6 种</p>
<p>详细请见idc.py 文件中  （这里只列八种）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">o_void     &#x3D; ida_ua.o_void      # No Operand                           ----------</span><br><span class="line">o_reg      &#x3D; ida_ua.o_reg       # General Register (al,ax,es,ds...)    reg</span><br><span class="line">o_mem      &#x3D; ida_ua.o_mem       # Direct Memory Reference  (DATA)      addr</span><br><span class="line">o_phrase   &#x3D; ida_ua.o_phrase    # Memory Ref [Base Reg + Index Reg]    phrase</span><br><span class="line">o_displ    &#x3D; ida_ua.o_displ     # Memory Reg [Base Reg + Index Reg + Displacement] phrase+addr</span><br><span class="line">o_imm      &#x3D; ida_ua.o_imm       # Immediate Value                      value</span><br><span class="line">o_far      &#x3D; ida_ua.o_far       # Immediate Far Address  (CODE)        addr</span><br><span class="line">o_near     &#x3D; ida_ua.o_near      # Immediate Near Address (CODE)        addr</span><br></pre></td></tr></table></figure>


<h3 id="交叉索引"><a href="#交叉索引" class="headerlink" title="交叉索引"></a>交叉索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xrefs &#x3D; idautils.CodeRefsTo(func, 1)</span><br></pre></td></tr></table></figure>


<p>使用交叉引用定位危险函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">danger_funcs &#x3D; [&#39;strcpy&#39;, &#39;memcpy&#39;, &#39;gets&#39;, &#39;strcat&#39;, &#39;scanf&#39;, &#39;fgets&#39;]</span><br><span class="line">for func in idautils.Functions():</span><br><span class="line">    func_name &#x3D; idc.get_func_name(func)</span><br><span class="line">    for danger_func in danger_funcs:</span><br><span class="line">        if danger_func in func_name:</span><br><span class="line">            xrefs &#x3D; idautils.CodeRefsTo(func, 0)  # 第二个参数我不确定</span><br><span class="line">            for xref in xrefs:</span><br><span class="line">                if idc.print_insn_mnem(xref) &#x3D;&#x3D; &quot;call&quot;:  # check to see if this cross-reference is a function call</span><br><span class="line">                    print(&quot;  called from %s(0x%x)&quot; % (idc.get_func_name(xref), xref))</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>


<p>注意idautils.CodeRefsTo和idautils.CodeRefsFrom的区别</p>
<h3 id="搜索binary"><a href="#搜索binary" class="headerlink" title="搜索binary"></a>搜索binary</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pattern &#x3D; &#39;55 8B EC&#39;#push ebp</span><br><span class="line">idc.find_binary(addr, idc.SEARCH_NEXT, pattern)</span><br><span class="line">idc.find_text(addr, idc.SEARCH_NEXT, 0, 0, searchstr)   #搜索字符串</span><br></pre></td></tr></table></figure>


<h3 id="patching"><a href="#patching" class="headerlink" title="patching"></a>patching</h3><p>补丁这个很常用  反调试  混淆等等都用得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ida_bytes.patch_bytes(ea, value)</span><br><span class="line">ida_bytes.patch_bytes(addr, b&quot;\x90\x90\x90\x90\x90\x90\x90&quot;)</span><br></pre></td></tr></table></figure>


<h3 id="rename"><a href="#rename" class="headerlink" title="rename"></a>rename</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idc.set_name(ea, name, flags)</span><br></pre></td></tr></table></figure>


<h3 id="访问原数据-转换成机器码"><a href="#访问原数据-转换成机器码" class="headerlink" title="访问原数据(转换成机器码)"></a>访问原数据(转换成机器码)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">idc.Byte(ea)</span><br><span class="line">idc.Word(ea)</span><br><span class="line">idc.GetManyBytes(ea,size)</span><br><span class="line">for byte in idc.GetManyBytes(ea,6):</span><br><span class="line">	print(&quot;0x%X&quot; %ord(byte))</span><br></pre></td></tr></table></figure>


<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/151898">https://www.anquanke.com/post/id/151898</a></p>
<p>idapython 手册</p>
<h3 id="扩展阅读"><a href="#扩展阅读" class="headerlink" title="扩展阅读"></a>扩展阅读</h3><p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-258831.htm">https://bbs.pediy.com/thread-258831.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-260127.htm">https://bbs.pediy.com/thread-260127.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/iweizime/DBGHider">https://github.com/iweizime/DBGHider</a></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>idapython的基本用法大概就这么多</p>
<p>还有一张总结很到位的图<br><a target="_blank" rel="noopener" href="https://bbs.pediy.com/upload/attach/202006/671106_PWX5AQEFFSYYHVU.png">https://bbs.pediy.com/upload/attach/202006/671106_PWX5AQEFFSYYHVU.png</a></p>
<p><img src="https://bbs.pediy.com/upload/attach/202006/671106_PWX5AQEFFSYYHVU.png#id=iMiFM&originHeight=180&originWidth=400&originalType=binary&status=done&style=none"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/24/cve-2018-1160/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/24/cve-2018-1160/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-24 18:42:25" itemprop="dateCreated datePublished" datetime="2021-04-24T18:42:25+08:00">2021-04-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-05-05 11:46:32" itemprop="dateModified" datetime="2021-05-05T11:46:32+08:00">2021-05-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="cve-2018-1160分析"><a href="#cve-2018-1160分析" class="headerlink" title="cve-2018-1160分析"></a>cve-2018-1160分析</h3><p>该bug允许未经认证的远程攻击者覆盖某些结构数据,可以控制执行流并绕过身份认证。</p>
<h5 id="源码方面"><a href="#源码方面" class="headerlink" title="源码方面"></a>源码方面</h5><p>netatalk – AFP(Apple Filing Protocol，AFP)的实现，  源码下载在SourceForge可以找到。</p>
<p>如果阅读源码的话，你会发现大部分的<strong>网络服务程序一般采用主进程循环监听请求的方式，当请求到来时，服务端将为其fork出一个子进程用于处理相关请求</strong>。说白了就是main里面一个while(1)始终监听，当请求到来时，会使用fork函数生成一个子进程专门处理。</p>
<h5 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h5><p>来到main函数 /etc/afpd/main.c</p>
<p>一开始设置了一些信号  接着进入while循环</p>
<p><img src="/2021/04/24/cve-2018-1160/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210427224012016.png" alt="image-20210427224012016"></p>
<p>configinit函数中 会初始化dsi结构体</p>
<p><img src="/2021/04/24/cve-2018-1160/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210427224110986.png" alt="image-20210427224110986"></p>
<p>初始化dsi-&gt;header</p>
<p><img src="/2021/04/24/cve-2018-1160/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210427224414733.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/20/linux%E8%84%8F%E7%89%9B%E6%BC%8F%E6%B4%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/20/linux%E8%84%8F%E7%89%9B%E6%BC%8F%E6%B4%9E/" class="post-title-link" itemprop="url">linux脏牛漏洞  dirty cow</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-20 21:05:36" itemprop="dateCreated datePublished" datetime="2021-04-20T21:05:36+08:00">2021-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-05-04 23:55:09" itemprop="dateModified" datetime="2021-05-04T23:55:09+08:00">2021-05-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="linux-脏牛漏洞（dirty-cow）"><a href="#linux-脏牛漏洞（dirty-cow）" class="headerlink" title="linux 脏牛漏洞（dirty cow）"></a>linux 脏牛漏洞（dirty cow）</h3><h3 id="CVE-2016–5195"><a href="#CVE-2016–5195" class="headerlink" title="CVE-2016–5195"></a>CVE-2016–5195</h3><h4 id="复现环境："><a href="#复现环境：" class="headerlink" title="复现环境："></a>复现环境：</h4><p><a target="_blank" rel="noopener" href="https://seedsecuritylabs.org/Labs_20.04/Software/Dirty_COW/">https://seedsecuritylabs.org/Labs_20.04/Software/Dirty_COW/</a></p>
<h4 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h4><p>该漏洞本质属于竞态条件漏洞</p>
<p>cow(copy on write)：</p>
<p>在Linux系统中，fork()会产生一个和父进程完全相同的子进程，但子进程在此后多会exec系统调用，出于效率考虑，Linux系统中引入了“写时复制”技术，也就是只有进程空间的各段的内容要发生变化时，才会将父进程的内容复制一份给子进程。</p>
<p>详细原理看这个：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hbhgyu/article/details/106245182">https://blog.csdn.net/hbhgyu/article/details/106245182</a></p>
<p>在linux的mmap函数中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void *mmap(void *addr, size_t length, int prot, int flags,int fd, off_t offset);</span><br></pre></td></tr></table></figure>

<p>该函数的作用是分配一块内存，用参数指定起始地址、内存大小、权限等。在flags标志中，MAP_PRIVATE这个标志位设置时会触发写时拷贝（cow），**其作用就是建立一个写入时拷贝的私有映射，内存区域的写入不会影响原文件，因此如果有别的进程在用这个文件，本进程在内存区域的改变只会影响COW的那个页而不影响这个文件)**。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#96;int madvise(void *addr, size_t length, int advice);&#96;</span><br></pre></td></tr></table></figure>

<p>这个函数的作用是告诉内核<code>addr,addr+len</code>这段区域的映射的内存或者共享内存的使用情况，方便内核以合适方式对其处理，<code>MADV_DONTNEED</code>这个表示接下来不再使用这块内存区域，内核可以释放它。</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><p>上面的实验环境上有</p>
<p><a target="_blank" rel="noopener" href="https://github.com/dirtycow/dirtycow.github.io/blob/master/dirtyc0w.c">https://github.com/dirtycow/dirtycow.github.io/blob/master/dirtyc0w.c</a></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>打进内网后  可以用来linux提权   提取su超级权限</p>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hbhgyu/article/details/106245182">https://blog.csdn.net/hbhgyu/article/details/106245182</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/04/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/04/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/" class="post-title-link" itemprop="url">plt表和got表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-04 00:17:11" itemprop="dateCreated datePublished" datetime="2021-04-04T00:17:11+08:00">2021-04-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-08 21:39:25" itemprop="dateModified" datetime="2021-04-08T21:39:25+08:00">2021-04-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近在刷pwn题    主要是在看堆的基础和pwn栈溢出的oj题</p>
<p>这里面plt和got表是必须要理解的  逆向也有用  有的题把这个给混淆了  看的函数都是subxxx，但是根据plt和got表原理可以还原（那个是qwb的xx_easy_server)</p>
<p>做个简单的小实验深入理解一下plt和got表</p>
<p>gcc test -o test.out</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">void win()&#123;</span><br><span class="line">    printf(&quot;you win\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    char a[100];</span><br><span class="line">    gets(a);</span><br><span class="line">    printf(&quot;you lose\n&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们首先利用odjump 指令查看got表</p>
<p><img src="/2021/04/04/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/Image.png" alt="Image"></p>
<p>接着打开gdb  在gdb里面disass gets</p>
<p><img src="/2021/04/04/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/Image-1617721215466.png" alt="Image"></p>
<p>disass puts</p>
<p><img src="/2021/04/04/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/Image-1617887123243.png" alt="Image"></p>
<p>我们可以看到这样一个结构  一般来讲 plt表都是 </p>
<p>jmp  xxx</p>
<p>push  xxx</p>
<p>jmp xxx</p>
<p>其中第一个jmp是跳到got表 </p>
<p>然后push一个值</p>
<p>接着jmp xxx  ，而puts@plt  和 gets@plt中第二个jmp都是一致的  都是PLT表的开始plt[0]</p>
<p>在plt[0]中  他做的事情是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">push got[1]</span><br><span class="line">jmp **got[2]</span><br></pre></td></tr></table></figure>

<p>实际上，他是在运行时重定位  找到真正的函数地址  并放在got表中  </p>
<p>这样第一次调用该函数值时，got表中没有值 通过第二个jump找到函数地址  并放在got表中 </p>
<p>这样当第二次调用时，got表中已有值 就只需要一个jmp就可以找到真正的函数地址</p>
<p>那push xx就是got表中的索引  可以看到上图中gets函数是push 0x3  而puts函数是push 0x0</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/27/pwn%E9%A2%98%E7%A7%AF%E7%B4%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/27/pwn%E9%A2%98%E7%A7%AF%E7%B4%AF/" class="post-title-link" itemprop="url">pwn基础总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-27 22:35:13" itemprop="dateCreated datePublished" datetime="2021-02-27T22:35:13+08:00">2021-02-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-11 17:51:25" itemprop="dateModified" datetime="2021-04-11T17:51:25+08:00">2021-04-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="基础pwn"><a href="#基础pwn" class="headerlink" title="基础pwn"></a>基础pwn</h3><p>在看此博客之前，读过i春秋的linux+pwn零基础入门以及小pwn题</p>
<h4 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h4><h5 id="rop"><a href="#rop" class="headerlink" title="rop"></a>rop</h5><h6 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h6><p>rop构造exp时，x86有一个小坑 ，即call函数调用和通过plt表调用略有不同，导致栈方面的问题，call函数调用的时候默认有一个保存的EIP,即返回地址。</p>
<p>构造exp时，公式如下：</p>
<p>shellcode = padding + 期望跳转地址 + 返回地址（EIP） +  期望跳转地址的参数</p>
<h6 id="x64"><a href="#x64" class="headerlink" title="x64"></a>x64</h6><p>在x64中，由于linux x64传参首先是通过相关寄存器，而不是直接通过栈传参，所以在构造exp时只需要找到需要的gadget即可    一般来说，shellcode = padding + 跳转地址 + xxxx （参数）+ 返回地址</p>
<p>xman里面的level0-level5都挺有意思的（从一开始有后门 再到libc 无libc的漏洞。。。）  目前都刷过了， 一步步进阶中</p>
<h6 id="arm"><a href="#arm" class="headerlink" title="arm"></a>arm</h6><h6 id="mips"><a href="#mips" class="headerlink" title="mips"></a>mips</h6><h5 id="stack-pivot"><a href="#stack-pivot" class="headerlink" title="stack pivot"></a>stack pivot</h5><h4 id="glibc-堆漏洞"><a href="#glibc-堆漏洞" class="headerlink" title="glibc  堆漏洞"></a>glibc  堆漏洞</h4><h5 id="堆溢出"><a href="#堆溢出" class="headerlink" title="堆溢出"></a>堆溢出</h5><h5 id="uaf"><a href="#uaf" class="headerlink" title="uaf"></a>uaf</h5><h5 id="double-free"><a href="#double-free" class="headerlink" title="double free"></a>double free</h5><h5 id="off-by-one"><a href="#off-by-one" class="headerlink" title="off-by-one"></a>off-by-one</h5><h5 id="unlink-攻击"><a href="#unlink-攻击" class="headerlink" title="unlink 攻击"></a>unlink 攻击</h5><p>在利用unlink攻击的时候，一般会有堆溢出</p>
<p>或者uaf和double free</p>
<h5 id="fastbin-attack"><a href="#fastbin-attack" class="headerlink" title="fastbin attack"></a>fastbin attack</h5><h4 id="接下来的题目"><a href="#接下来的题目" class="headerlink" title="接下来的题目"></a>接下来的题目</h4><p><img src="/2021/02/27/pwn%E9%A2%98%E7%A7%AF%E7%B4%AF/image-20210411174736372.png" alt="image-20210411174736372"></p>
<p>堆题已经在刷了   gkdgkd</p>
<p><img src="/2021/02/27/pwn%E9%A2%98%E7%A7%AF%E7%B4%AF/image-20210411174805433.png" alt="image-20210411174805433"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/16/%E9%80%86%E5%90%91%E9%A2%98%E5%BA%93%E7%A7%AF%E7%B4%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/16/%E9%80%86%E5%90%91%E9%A2%98%E5%BA%93%E7%A7%AF%E7%B4%AF/" class="post-title-link" itemprop="url">逆向题积累</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-16 13:09:47" itemprop="dateCreated datePublished" datetime="2021-02-16T13:09:47+08:00">2021-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-05 22:47:26" itemprop="dateModified" datetime="2021-04-05T22:47:26+08:00">2021-04-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一道一道写wp比较麻烦，本文章列出每一道题的考察点，高质量的题汇总，慢慢的积少成多。</p>
<h5 id="2020justctf—–debug-me-if-you-can-RE"><a href="#2020justctf—–debug-me-if-you-can-RE" class="headerlink" title="2020justctf—–debug_me_if_you_can-RE"></a>2020justctf—–debug_me_if_you_can-RE</h5><p>涉及到高级反调试技术（nanomite）  ptrace用法  以及 idapython脚本编写与使用</p>
<p>详细wp:<a target="_blank" rel="noopener" href="https://mrt4ntr4.github.io/JustCTF-debugme/#Role-of-Father-Process">https://mrt4ntr4.github.io/JustCTF-debugme/#Role-of-Father-Process</a></p>
<h5 id="2020第五空间—-ManageCode"><a href="#2020第五空间—-ManageCode" class="headerlink" title="2020第五空间—-ManageCode"></a>2020第五空间—-ManageCode</h5><p>c#  根据dnspy偏移信息在ida中找到关键位置  并进行逆向</p>
<h5 id="2020dragonctf—-RetroZeit"><a href="#2020dragonctf—-RetroZeit" class="headerlink" title="2020dragonctf—-RetroZeit"></a>2020dragonctf—-RetroZeit</h5><p>新平台下的逆向  用grida看的   其实算法很简单 感觉考察的还是快速学习能力和读汇编能力</p>
<p>逆向用到mc680000指令集</p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-88912.htm">https://bbs.pediy.com/thread-88912.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://web.njit.edu/~rosensta/classes/architecture/252software/code.pdf">https://web.njit.edu/~rosensta/classes/architecture/252software/code.pdf</a></p>
<h5 id="go语言逆向"><a href="#go语言逆向" class="headerlink" title="go语言逆向"></a>go语言逆向</h5><p>很多题都是用go语言写的 ，github有个脚本加载一下，后面逆向就和原来差不多，具体题目就没记录。</p>
<h5 id="2020强网杯—-xx-warmup-obf"><a href="#2020强网杯—-xx-warmup-obf" class="headerlink" title="2020强网杯—-xx_warmup_obf"></a>2020强网杯—-xx_warmup_obf</h5><p>这道题前面初始化的时候注册了SEH， 后面用的int 3  反调试，需要在ida中设置将信号pass application</p>
<p>安卓和mips的逆向还需多加练习（未带完善）</p>
<h5 id="mips逆向及环境搭建"><a href="#mips逆向及环境搭建" class="headerlink" title="mips逆向及环境搭建"></a>mips逆向及环境搭建</h5><p>qemu是个神器</p>
<p>里面有各种架构的模拟  arm mips riscv</p>
<p>还可以下载mips-linux-gnu  可以编译c  生成mips架构的可执行文件</p>
<p>-g 参数绑定端口</p>
<p>-L 指定链接库位置（因为有一次出现了no found /usr/ld.so.1 ，所以改成了这个，但需要下载mips-linux-gnu）</p>
<p>ida 7.5 可以直接动态调试  万能的f5</p>
<p>qemu-mips-static -L /usr/mips-linux-gnu/ -g 12345 re</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/16/unity3d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/violin.jpg">
      <meta itemprop="name" content="fruit">
      <meta itemprop="description" content="问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fruit's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/16/unity3d/" class="post-title-link" itemprop="url">unity3d逆向简介</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-16 13:09:24" itemprop="dateCreated datePublished" datetime="2021-02-16T13:09:24+08:00">2021-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-27 22:53:42" itemprop="dateModified" datetime="2021-02-27T22:53:42+08:00">2021-02-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>简单介绍一下unity游戏逆向</p>
<p>从基本开始</p>
<p>assemble_csharp.dll   存放游戏主逻辑</p>
<p>global-metadata.dat 存放字符串</p>
<p>使用i2lcppdumper进行一个dumper</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Perfare/Il2CppDumper">Il2CppDumper</a>成功运行后  会生成 dump.cs   script.json  stringliteral.json  dummydll（文件夹）</p>
<p>其中dump.cs包含了反编译出的C#类定义以及在so文件中对应的偏移地址</p>
<p>stringliteral.json包含了so文件中的字符串常量以及对应的偏移地址</p>
<p>我们用dnspy 打开assemble_csharp.dll 可以发现没有逻辑  只能看到偏移量  像这样：</p>
<p><img src="/2021/02/16/unity3d/image-20210220151112560.png" alt="image-20210220151112560"></p>
<p>我们可以看到rva  offset 和va然后去定位 （2020第五空间re的一道题就是这么定位的我记得，当时太菜不懂还）</p>
<p>用ida打开   使用ida_struct脚本 就可以看得差不多了</p>
<p>这篇文章详细介绍了变量反编译后的形态，比如如何去找静态变量。<a target="_blank" rel="noopener" href="https://www.perfare.net/1408.html">https://www.perfare.net/1408.html</a></p>
<p>后面的有点复杂 不太好说  不过很有意思。。不过基本的就这些  </p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.touuki.com/archives/153">https://blog.touuki.com/archives/153</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fruit"
      src="/images/violin.jpg">
  <p class="site-author-name" itemprop="name">fruit</p>
  <div class="site-description" itemprop="description">问灵十三载，等一不归人  欢迎交流：3209820155qq 添加备注：blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
	
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fruit</span>
  <span class="post-meta-divider">|</span>
<span id="busuanzi_container_site_pv">
	<span class="post-meta-item-icon">
		<i class="fa fa-eye"></i>
	</span>
	访问量：<span id="busuanzi_value_site_pv"></span> 次数
</span>

<span class="post-meta-divider">|</span>
	<span id="busuanzi_container_site_uv">
	访客数：<span id="busuanzi_value_site_uv"></span> 人次
</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
